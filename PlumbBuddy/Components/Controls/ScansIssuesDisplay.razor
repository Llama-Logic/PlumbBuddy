@implements IDisposable
@inject IDialogService DialogService
@inject IDispatcher Dispatcher
@inject ISmartSimObserver SmartSimObserver

<MudGrid Justify="Justify.Center">
    @foreach (var scanIssue in SmartSimObserver.ScanIssues)
    {
        <MudItem xs="4">
            <MudCard Elevation="5">
                <MudCardHeader>
                    <CardHeaderAvatar>
                        <MudAvatar Color="@(scanIssue.Type switch { ScanIssueType.Dead => Color.Dark, ScanIssueType.Sick => Color.Error, ScanIssueType.Uncomfortable => Color.Warning, _ => Color.Success })" Variant="Variant.Filled">
                            <MudIcon Icon="@scanIssue.Icon" Color="@(scanIssue.Type switch { ScanIssueType.Dead => Color.Error, _ => Color.Default })" Size="Size.Large" />
                        </MudAvatar>
                    </CardHeaderAvatar>
                    <CardHeaderContent>
                        <MudTextM3 Typo="TypoM3.Title">@scanIssue.Caption</MudTextM3>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent>
                    <MudMarkdown Value="@scanIssue.Description" />
                </MudCardContent>
                @if (scanIssue.Data is not null && scanIssue.Resolutions is not null && scanIssue.Resolutions.Count > 0)
                {
                    <MudCardActions>
                        @foreach (var resolution in scanIssue.Resolutions)
                        {
                            <MudButton StartIcon="@resolution.Icon" IconColor="@resolution.Color" Color="@resolution.Color" OnClick="() => ResolveAsync(scanIssue, resolution)">@resolution.Label</MudButton>
                        }
                    </MudCardActions>
                }
            </MudCard>
        </MudItem>
    }
</MudGrid>